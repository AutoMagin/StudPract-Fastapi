{"ast":null,"code":"import React,{useState,useContext}from'react';import{postService}from'../services/postService';import{AuthContext}from'../contexts/AuthContext';import{Typography,Box,Button,TextField}from'@mui/material';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Post(_ref){let{post}=_ref;const{user}=useContext(AuthContext);const[isEditing,setIsEditing]=useState(false);const[title,setTitle]=useState(post.title);const[content,setContent]=useState(post.content);const[error,setError]=useState(null);const[postState,setPostState]=useState(post);const handleLike=async()=>{try{if(postState.liked_by_me){const updatedPost=await postService.unlikePost(postState.id);setPostState(updatedPost);}else{const updatedPost=await postService.likePost(postState.id);setPostState(updatedPost);}}catch(err){var _err$response,_err$response2,_err$response2$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401?'Необходима авторизация':((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.detail)||err.message||'Произошла ошибка');}};const handleEdit=async()=>{try{const updatedPost=await postService.updatePost(postState.id,{title,content});setPostState(updatedPost);setIsEditing(false);}catch(err){var _err$response3,_err$response4,_err$response4$data;setError(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===401?'Необходима авторизация':((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.detail)||err.message||'Произошла ошибка');}};const handleDelete=async()=>{try{await postService.deletePost(postState.id);window.location.reload();}catch(err){var _err$response5,_err$response6,_err$response6$data;setError(((_err$response5=err.response)===null||_err$response5===void 0?void 0:_err$response5.status)===401?'Необходима авторизация':((_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.detail)||err.message||'Произошла ошибка');}};const isOwnPost=user&&user.id===postState.user_id;return/*#__PURE__*/_jsxs(Box,{className:\"post\",children:[error&&/*#__PURE__*/_jsx(Typography,{color:\"error\",children:error}),isEditing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TextField,{label:\"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\",value:title,onChange:e=>setTitle(e.target.value),fullWidth:true,margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{label:\"\\u0421\\u043E\\u0434\\u0435\\u0440\\u0436\\u0430\\u043D\\u0438\\u0435\",value:content,onChange:e=>setContent(e.target.value),fullWidth:true,margin:\"normal\",multiline:true}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleEdit,style:{marginRight:'1rem'},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>setIsEditing(false),children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:postState.title}),/*#__PURE__*/_jsx(Typography,{children:postState.content}),/*#__PURE__*/_jsxs(Typography,{children:[\"\\u041B\\u0430\\u0439\\u043A\\u043E\\u0432: \",postState.likes_count]}),user&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:postState.liked_by_me?\"secondary\":\"primary\",onClick:handleLike,style:{marginTop:'0.5rem'},children:postState.liked_by_me?\"Убрать лайк\":\"Лайк\"}),isOwnPost&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:()=>setIsEditing(true),style:{marginTop:'0.5rem',marginLeft:'1rem'},children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"error\",onClick:handleDelete,style:{marginTop:'0.5rem',marginLeft:'1rem'},children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]})]});}","map":{"version":3,"names":["React","useState","useContext","postService","AuthContext","Typography","Box","Button","TextField","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Post","_ref","post","user","isEditing","setIsEditing","title","setTitle","content","setContent","error","setError","postState","setPostState","handleLike","liked_by_me","updatedPost","unlikePost","id","likePost","err","_err$response","_err$response2","_err$response2$data","response","status","data","detail","message","handleEdit","updatePost","_err$response3","_err$response4","_err$response4$data","handleDelete","deletePost","window","location","reload","_err$response5","_err$response6","_err$response6$data","isOwnPost","user_id","className","children","color","label","value","onChange","e","target","fullWidth","margin","multiline","variant","onClick","style","marginRight","likes_count","marginTop","marginLeft"],"sources":["C:/Users/zo-al/Desktop/studa_practe/frontend/src/components/Post.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { postService } from '../services/postService';\r\nimport { AuthContext } from '../contexts/AuthContext';\r\nimport { Typography, Box, Button, TextField } from '@mui/material';\r\n\r\nexport default function Post({ post }) {\r\n  const { user } = useContext(AuthContext);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [title, setTitle] = useState(post.title);\r\n  const [content, setContent] = useState(post.content);\r\n  const [error, setError] = useState(null);\r\n  const [postState, setPostState] = useState(post);\r\n\r\n  const handleLike = async () => {\r\n    try {\r\n      if (postState.liked_by_me) {\r\n        const updatedPost = await postService.unlikePost(postState.id);\r\n        setPostState(updatedPost);\r\n      } else {\r\n        const updatedPost = await postService.likePost(postState.id);\r\n        setPostState(updatedPost);\r\n      }\r\n    } catch (err) {\r\n      setError(\r\n        err.response?.status === 401\r\n          ? 'Необходима авторизация'\r\n          : err.response?.data?.detail || err.message || 'Произошла ошибка'\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleEdit = async () => {\r\n    try {\r\n      const updatedPost = await postService.updatePost(postState.id, { title, content });\r\n      setPostState(updatedPost);\r\n      setIsEditing(false);\r\n    } catch (err) {\r\n      setError(\r\n        err.response?.status === 401\r\n          ? 'Необходима авторизация'\r\n          : err.response?.data?.detail || err.message || 'Произошла ошибка'\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    try {\r\n      await postService.deletePost(postState.id);\r\n      window.location.reload();\r\n    } catch (err) {\r\n      setError(\r\n        err.response?.status === 401\r\n          ? 'Необходима авторизация'\r\n          : err.response?.data?.detail || err.message || 'Произошла ошибка'\r\n      );\r\n    }\r\n  };\r\n\r\n  const isOwnPost = user && user.id === postState.user_id;\r\n\r\n  return (\r\n    <Box className=\"post\">\r\n      {error && <Typography color=\"error\">{error}</Typography>}\r\n      {isEditing ? (\r\n        <>\r\n          <TextField\r\n            label=\"Заголовок\"\r\n            value={title}\r\n            onChange={(e) => setTitle(e.target.value)}\r\n            fullWidth\r\n            margin=\"normal\"\r\n          />\r\n          <TextField\r\n            label=\"Содержание\"\r\n            value={content}\r\n            onChange={(e) => setContent(e.target.value)}\r\n            fullWidth\r\n            margin=\"normal\"\r\n            multiline\r\n          />\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={handleEdit}\r\n            style={{ marginRight: '1rem' }}\r\n          >\r\n            Сохранить\r\n          </Button>\r\n          <Button variant=\"outlined\" onClick={() => setIsEditing(false)}>\r\n            Отмена\r\n          </Button>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <Typography variant=\"h6\">{postState.title}</Typography>\r\n          <Typography>{postState.content}</Typography>\r\n          <Typography>Лайков: {postState.likes_count}</Typography>\r\n          {user && (\r\n            <Button\r\n              variant=\"contained\"\r\n              color={postState.liked_by_me ? \"secondary\" : \"primary\"}\r\n              onClick={handleLike}\r\n              style={{ marginTop: '0.5rem' }}\r\n            >\r\n              {postState.liked_by_me ? \"Убрать лайк\" : \"Лайк\"}\r\n            </Button>\r\n          )}\r\n          {isOwnPost && (\r\n            <>\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                onClick={() => setIsEditing(true)}\r\n                style={{ marginTop: '0.5rem', marginLeft: '1rem' }}\r\n              >\r\n                Редактировать\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"error\"\r\n                onClick={handleDelete}\r\n                style={{ marginTop: '0.5rem', marginLeft: '1rem' }}\r\n              >\r\n                Удалить\r\n              </Button>\r\n            </>\r\n          )}\r\n        </>\r\n      )}\r\n    </Box>\r\n  );\r\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CACnD,OAASC,WAAW,KAAQ,yBAAyB,CACrD,OAASC,WAAW,KAAQ,yBAAyB,CACrD,OAASC,UAAU,CAAEC,GAAG,CAAEC,MAAM,CAAEC,SAAS,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnE,cAAe,SAAS,CAAAC,IAAIA,CAAAC,IAAA,CAAW,IAAV,CAAEC,IAAK,CAAC,CAAAD,IAAA,CACnC,KAAM,CAAEE,IAAK,CAAC,CAAGhB,UAAU,CAACE,WAAW,CAAC,CACxC,KAAM,CAACe,SAAS,CAAEC,YAAY,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAACgB,IAAI,CAACI,KAAK,CAAC,CAC9C,KAAM,CAACE,OAAO,CAAEC,UAAU,CAAC,CAAGvB,QAAQ,CAACgB,IAAI,CAACM,OAAO,CAAC,CACpD,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGzB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAAC0B,SAAS,CAAEC,YAAY,CAAC,CAAG3B,QAAQ,CAACgB,IAAI,CAAC,CAEhD,KAAM,CAAAY,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,GAAIF,SAAS,CAACG,WAAW,CAAE,CACzB,KAAM,CAAAC,WAAW,CAAG,KAAM,CAAA5B,WAAW,CAAC6B,UAAU,CAACL,SAAS,CAACM,EAAE,CAAC,CAC9DL,YAAY,CAACG,WAAW,CAAC,CAC3B,CAAC,IAAM,CACL,KAAM,CAAAA,WAAW,CAAG,KAAM,CAAA5B,WAAW,CAAC+B,QAAQ,CAACP,SAAS,CAACM,EAAE,CAAC,CAC5DL,YAAY,CAACG,WAAW,CAAC,CAC3B,CACF,CAAE,MAAOI,GAAG,CAAE,KAAAC,aAAA,CAAAC,cAAA,CAAAC,mBAAA,CACZZ,QAAQ,CACN,EAAAU,aAAA,CAAAD,GAAG,CAACI,QAAQ,UAAAH,aAAA,iBAAZA,aAAA,CAAcI,MAAM,IAAK,GAAG,CACxB,wBAAwB,CACxB,EAAAH,cAAA,CAAAF,GAAG,CAACI,QAAQ,UAAAF,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcI,IAAI,UAAAH,mBAAA,iBAAlBA,mBAAA,CAAoBI,MAAM,GAAIP,GAAG,CAACQ,OAAO,EAAI,kBACnD,CAAC,CACH,CACF,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAAb,WAAW,CAAG,KAAM,CAAA5B,WAAW,CAAC0C,UAAU,CAAClB,SAAS,CAACM,EAAE,CAAE,CAAEZ,KAAK,CAAEE,OAAQ,CAAC,CAAC,CAClFK,YAAY,CAACG,WAAW,CAAC,CACzBX,YAAY,CAAC,KAAK,CAAC,CACrB,CAAE,MAAOe,GAAG,CAAE,KAAAW,cAAA,CAAAC,cAAA,CAAAC,mBAAA,CACZtB,QAAQ,CACN,EAAAoB,cAAA,CAAAX,GAAG,CAACI,QAAQ,UAAAO,cAAA,iBAAZA,cAAA,CAAcN,MAAM,IAAK,GAAG,CACxB,wBAAwB,CACxB,EAAAO,cAAA,CAAAZ,GAAG,CAACI,QAAQ,UAAAQ,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcN,IAAI,UAAAO,mBAAA,iBAAlBA,mBAAA,CAAoBN,MAAM,GAAIP,GAAG,CAACQ,OAAO,EAAI,kBACnD,CAAC,CACH,CACF,CAAC,CAED,KAAM,CAAAM,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAA9C,WAAW,CAAC+C,UAAU,CAACvB,SAAS,CAACM,EAAE,CAAC,CAC1CkB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAE,MAAOlB,GAAG,CAAE,KAAAmB,cAAA,CAAAC,cAAA,CAAAC,mBAAA,CACZ9B,QAAQ,CACN,EAAA4B,cAAA,CAAAnB,GAAG,CAACI,QAAQ,UAAAe,cAAA,iBAAZA,cAAA,CAAcd,MAAM,IAAK,GAAG,CACxB,wBAAwB,CACxB,EAAAe,cAAA,CAAApB,GAAG,CAACI,QAAQ,UAAAgB,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcd,IAAI,UAAAe,mBAAA,iBAAlBA,mBAAA,CAAoBd,MAAM,GAAIP,GAAG,CAACQ,OAAO,EAAI,kBACnD,CAAC,CACH,CACF,CAAC,CAED,KAAM,CAAAc,SAAS,CAAGvC,IAAI,EAAIA,IAAI,CAACe,EAAE,GAAKN,SAAS,CAAC+B,OAAO,CAEvD,mBACE5C,KAAA,CAACR,GAAG,EAACqD,SAAS,CAAC,MAAM,CAAAC,QAAA,EAClBnC,KAAK,eAAIf,IAAA,CAACL,UAAU,EAACwD,KAAK,CAAC,OAAO,CAAAD,QAAA,CAAEnC,KAAK,CAAa,CAAC,CACvDN,SAAS,cACRL,KAAA,CAAAF,SAAA,EAAAgD,QAAA,eACElD,IAAA,CAACF,SAAS,EACRsD,KAAK,CAAC,wDAAW,CACjBC,KAAK,CAAE1C,KAAM,CACb2C,QAAQ,CAAGC,CAAC,EAAK3C,QAAQ,CAAC2C,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAC1CI,SAAS,MACTC,MAAM,CAAC,QAAQ,CAChB,CAAC,cACF1D,IAAA,CAACF,SAAS,EACRsD,KAAK,CAAC,8DAAY,CAClBC,KAAK,CAAExC,OAAQ,CACfyC,QAAQ,CAAGC,CAAC,EAAKzC,UAAU,CAACyC,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAC5CI,SAAS,MACTC,MAAM,CAAC,QAAQ,CACfC,SAAS,MACV,CAAC,cACF3D,IAAA,CAACH,MAAM,EACL+D,OAAO,CAAC,WAAW,CACnBT,KAAK,CAAC,SAAS,CACfU,OAAO,CAAE3B,UAAW,CACpB4B,KAAK,CAAE,CAAEC,WAAW,CAAE,MAAO,CAAE,CAAAb,QAAA,CAChC,wDAED,CAAQ,CAAC,cACTlD,IAAA,CAACH,MAAM,EAAC+D,OAAO,CAAC,UAAU,CAACC,OAAO,CAAEA,CAAA,GAAMnD,YAAY,CAAC,KAAK,CAAE,CAAAwC,QAAA,CAAC,sCAE/D,CAAQ,CAAC,EACT,CAAC,cAEH9C,KAAA,CAAAF,SAAA,EAAAgD,QAAA,eACElD,IAAA,CAACL,UAAU,EAACiE,OAAO,CAAC,IAAI,CAAAV,QAAA,CAAEjC,SAAS,CAACN,KAAK,CAAa,CAAC,cACvDX,IAAA,CAACL,UAAU,EAAAuD,QAAA,CAAEjC,SAAS,CAACJ,OAAO,CAAa,CAAC,cAC5CT,KAAA,CAACT,UAAU,EAAAuD,QAAA,EAAC,wCAAQ,CAACjC,SAAS,CAAC+C,WAAW,EAAa,CAAC,CACvDxD,IAAI,eACHR,IAAA,CAACH,MAAM,EACL+D,OAAO,CAAC,WAAW,CACnBT,KAAK,CAAElC,SAAS,CAACG,WAAW,CAAG,WAAW,CAAG,SAAU,CACvDyC,OAAO,CAAE1C,UAAW,CACpB2C,KAAK,CAAE,CAAEG,SAAS,CAAE,QAAS,CAAE,CAAAf,QAAA,CAE9BjC,SAAS,CAACG,WAAW,CAAG,aAAa,CAAG,MAAM,CACzC,CACT,CACA2B,SAAS,eACR3C,KAAA,CAAAF,SAAA,EAAAgD,QAAA,eACElD,IAAA,CAACH,MAAM,EACL+D,OAAO,CAAC,WAAW,CACnBT,KAAK,CAAC,SAAS,CACfU,OAAO,CAAEA,CAAA,GAAMnD,YAAY,CAAC,IAAI,CAAE,CAClCoD,KAAK,CAAE,CAAEG,SAAS,CAAE,QAAQ,CAAEC,UAAU,CAAE,MAAO,CAAE,CAAAhB,QAAA,CACpD,gFAED,CAAQ,CAAC,cACTlD,IAAA,CAACH,MAAM,EACL+D,OAAO,CAAC,WAAW,CACnBT,KAAK,CAAC,OAAO,CACbU,OAAO,CAAEtB,YAAa,CACtBuB,KAAK,CAAE,CAAEG,SAAS,CAAE,QAAQ,CAAEC,UAAU,CAAE,MAAO,CAAE,CAAAhB,QAAA,CACpD,4CAED,CAAQ,CAAC,EACT,CACH,EACD,CACH,EACE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}