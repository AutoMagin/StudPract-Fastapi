{"ast":null,"code":"import React,{useEffect,useState}from'react';import{userService}from'../services/userService';import{useLoading}from'../contexts/LoadingContext';import{Typography,Box,List,ListItem,ListItemText,Pagination,FormControl,InputLabel,Select,MenuItem}from'@mui/material';import{Link}from'react-router-dom';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";export function Users(){const[usersResponse,setUsersResponse]=useState({users:[],total:0,skip:0,limit:5});const[page,setPage]=useState(1);const[limit,setLimit]=useState(5);// По умолчанию 5 пользователей на странице\nconst[sortBy,setSortBy]=useState('id');// По умолчанию сортировка по ID (возрастание)\nconst[error,setError]=useState(null);const{setLoading}=useLoading();const fetchUsers=async()=>{setLoading(true);try{const skip=(page-1)*limit;const response=await userService.getUsers(skip,limit,sortBy);setUsersResponse(response);setLoading(false);}catch(err){var _err$response,_err$response2,_err$response3,_err$response3$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401?'Необходима авторизация':((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===404?'Пользователи не найдены':((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.detail)||err.message||'Произошла ошибка при загрузке пользователей');setLoading(false);}};useEffect(()=>{fetchUsers();},[page,limit,sortBy,setLoading]);const handlePageChange=(event,value)=>{setPage(value);};const handleLimitChange=event=>{setLimit(event.target.value);setPage(1);// Сбрасываем страницу на первую при изменении количества на странице\n};const handleSortByChange=event=>{setSortBy(event.target.value);setPage(1);// Сбрасываем страницу на первую при изменении сортировки\n};if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});const totalPages=Math.ceil(usersResponse.total/limit);return/*#__PURE__*/_jsxs(Box,{className:\"container\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0438\"}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsxs(Typography,{children:[\"\\u0412\\u0441\\u0435\\u0433\\u043E \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439: \",usersResponse.total]}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:2,children:[/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",size:\"small\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430\"}),/*#__PURE__*/_jsxs(Select,{value:sortBy,onChange:handleSortByChange,label:\"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"id\",children:\"\\u041F\\u043E ID (\\u0432\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442\\u0430\\u043D\\u0438\\u0435)\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"id_desc\",children:\"\\u041F\\u043E ID (\\u0443\\u0431\\u044B\\u0432\\u0430\\u043D\\u0438\\u0435)\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"name\",children:\"\\u041F\\u043E \\u0438\\u043C\\u0435\\u043D\\u0438 (\\u0432\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442\\u0430\\u043D\\u0438\\u0435)\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"name_desc\",children:\"\\u041F\\u043E \\u0438\\u043C\\u0435\\u043D\\u0438 (\\u0443\\u0431\\u044B\\u0432\\u0430\\u043D\\u0438\\u0435)\"})]})]}),/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",size:\"small\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"\\u041D\\u0430 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0435\"}),/*#__PURE__*/_jsxs(Select,{value:limit,onChange:handleLimitChange,label:\"\\u041D\\u0430 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0435\",children:[/*#__PURE__*/_jsx(MenuItem,{value:5,children:\"5\"}),/*#__PURE__*/_jsx(MenuItem,{value:20,children:\"20\"}),/*#__PURE__*/_jsx(MenuItem,{value:100,children:\"100\"})]})]})]})]}),usersResponse.users.length===0?/*#__PURE__*/_jsx(Typography,{children:\"\\u041D\\u0435\\u0442 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439\"}):/*#__PURE__*/_jsx(List,{children:usersResponse.users.map(user=>/*#__PURE__*/_jsx(ListItem,{component:Link,to:`/users/${user.id}`,children:/*#__PURE__*/_jsx(ListItemText,{primary:user.name||`User ${user.id}`,secondary:`Логин: ${user.login}`})},user.id))}),totalPages>1&&/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",mt:2,children:/*#__PURE__*/_jsx(Pagination,{count:totalPages,page:page,onChange:handlePageChange,color:\"primary\"})})]});}","map":{"version":3,"names":["React","useEffect","useState","userService","useLoading","Typography","Box","List","ListItem","ListItemText","Pagination","FormControl","InputLabel","Select","MenuItem","Link","jsxs","_jsxs","jsx","_jsx","Users","usersResponse","setUsersResponse","users","total","skip","limit","page","setPage","setLimit","sortBy","setSortBy","error","setError","setLoading","fetchUsers","response","getUsers","err","_err$response","_err$response2","_err$response3","_err$response3$data","status","data","detail","message","handlePageChange","event","value","handleLimitChange","target","handleSortByChange","className","children","totalPages","Math","ceil","variant","gutterBottom","display","justifyContent","alignItems","mb","gap","size","onChange","label","length","map","user","component","to","id","primary","name","secondary","login","mt","count","color"],"sources":["C:/Users/zo-al/Desktop/studa_practe/frontend/src/components/Users.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { userService } from '../services/userService';\r\nimport { useLoading } from '../contexts/LoadingContext';\r\nimport { Typography, Box, List, ListItem, ListItemText, Pagination, FormControl, InputLabel, Select, MenuItem } from '@mui/material';\r\nimport { Link } from 'react-router-dom';\r\n\r\nexport function Users() {\r\n  const [usersResponse, setUsersResponse] = useState({ users: [], total: 0, skip: 0, limit: 5 });\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(5); // По умолчанию 5 пользователей на странице\r\n  const [sortBy, setSortBy] = useState('id'); // По умолчанию сортировка по ID (возрастание)\r\n  const [error, setError] = useState(null);\r\n  const { setLoading } = useLoading();\r\n\r\n  const fetchUsers = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const skip = (page - 1) * limit;\r\n      const response = await userService.getUsers(skip, limit, sortBy);\r\n      setUsersResponse(response);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      setError(\r\n        err.response?.status === 401\r\n          ? 'Необходима авторизация'\r\n          : err.response?.status === 404\r\n          ? 'Пользователи не найдены'\r\n          : err.response?.data?.detail || err.message || 'Произошла ошибка при загрузке пользователей'\r\n      );\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, [page, limit, sortBy, setLoading]);\r\n\r\n  const handlePageChange = (event, value) => {\r\n    setPage(value);\r\n  };\r\n\r\n  const handleLimitChange = (event) => {\r\n    setLimit(event.target.value);\r\n    setPage(1); // Сбрасываем страницу на первую при изменении количества на странице\r\n  };\r\n\r\n  const handleSortByChange = (event) => {\r\n    setSortBy(event.target.value);\r\n    setPage(1); // Сбрасываем страницу на первую при изменении сортировки\r\n  };\r\n\r\n  if (error) return <div className=\"error\">Ошибка: {error}</div>;\r\n\r\n  const totalPages = Math.ceil(usersResponse.total / limit);\r\n\r\n  return (\r\n    <Box className=\"container\">\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        Пользователи\r\n      </Typography>\r\n      <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\r\n        <Typography>Всего пользователей: {usersResponse.total}</Typography>\r\n        <Box display=\"flex\" gap={2}>\r\n          <FormControl variant=\"outlined\" size=\"small\">\r\n            <InputLabel>Сортировка</InputLabel>\r\n            <Select\r\n              value={sortBy}\r\n              onChange={handleSortByChange}\r\n              label=\"Сортировка\"\r\n            >\r\n              <MenuItem value=\"id\">По ID (возрастание)</MenuItem>\r\n              <MenuItem value=\"id_desc\">По ID (убывание)</MenuItem>\r\n              <MenuItem value=\"name\">По имени (возрастание)</MenuItem>\r\n              <MenuItem value=\"name_desc\">По имени (убывание)</MenuItem>\r\n            </Select>\r\n          </FormControl>\r\n          <FormControl variant=\"outlined\" size=\"small\">\r\n            <InputLabel>На странице</InputLabel>\r\n            <Select\r\n              value={limit}\r\n              onChange={handleLimitChange}\r\n              label=\"На странице\"\r\n            >\r\n              <MenuItem value={5}>5</MenuItem>\r\n              <MenuItem value={20}>20</MenuItem>\r\n              <MenuItem value={100}>100</MenuItem>\r\n            </Select>\r\n          </FormControl>\r\n        </Box>\r\n      </Box>\r\n      {usersResponse.users.length === 0 ? (\r\n        <Typography>Нет пользователей</Typography>\r\n      ) : (\r\n        <List>\r\n          {usersResponse.users.map((user) => (\r\n            <ListItem key={user.id} component={Link} to={`/users/${user.id}`}>\r\n              <ListItemText primary={user.name || `User ${user.id}`} secondary={`Логин: ${user.login}`} />\r\n            </ListItem>\r\n          ))}\r\n        </List>\r\n      )}\r\n      {totalPages > 1 && (\r\n        <Box display=\"flex\" justifyContent=\"center\" mt={2}>\r\n          <Pagination\r\n            count={totalPages}\r\n            page={page}\r\n            onChange={handlePageChange}\r\n            color=\"primary\"\r\n          />\r\n        </Box>\r\n      )}\r\n    </Box>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}