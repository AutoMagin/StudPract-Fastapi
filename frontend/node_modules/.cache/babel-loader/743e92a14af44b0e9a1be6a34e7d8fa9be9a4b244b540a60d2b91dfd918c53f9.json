{"ast":null,"code":"import React,{useEffect,useState,useContext}from'react';import{useParams}from'react-router-dom';import{userService}from'../services/userService';import{postService}from'../services/postService';import{AuthContext}from'../contexts/AuthContext';import{useLoading}from'../contexts/LoadingContext';import{Typography,Box,Button}from'@mui/material';import Post from'./Post';import{CreatePost}from'./CreatePost';import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export function Profile(){const{id}=useParams();const{user}=useContext(AuthContext);const[profile,setProfile]=useState(null);const[posts,setPosts]=useState([]);const[error,setError]=useState(null);const{setLoading}=useLoading();const fetchProfile=async()=>{setLoading(true);try{const userResponse=await userService.get(id);setProfile(userResponse);const postsResponse=await postService.getPostsByUser(id);setPosts(postsResponse);}catch(err){var _err$response,_err$response2,_err$response3,_err$response3$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401?'Необходима авторизация':((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===404?'Пользователь или посты не найдены':((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.detail)||err.message||'Произошла ошибка при загрузке профиля');}finally{setLoading(false);}};useEffect(()=>{fetchProfile();},[id,setLoading]);if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});}if(!profile){return/*#__PURE__*/_jsx(Typography,{className:\"container\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"});}const isOwnProfile=user&&user.id===parseInt(id);return/*#__PURE__*/_jsxs(Box,{className:\"container\",children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",gutterBottom:true,children:[\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \",profile.name||`User ${profile.id}`]}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",children:[\"\\u041B\\u043E\\u0433\\u0438\\u043D: \",profile.login]}),isOwnProfile&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",component:\"a\",href:`/users/${id}/update`,style:{margin:'1rem 0'},children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsx(CreatePost,{userId:id,onPostCreated:fetchProfile})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,style:{marginTop:'2rem'},children:\"\\u041F\\u043E\\u0441\\u0442\\u044B\"}),posts.length===0?/*#__PURE__*/_jsx(Typography,{children:\"\\u041D\\u0435\\u0442 \\u043F\\u043E\\u0441\\u0442\\u043E\\u0432\"}):posts.map(post=>/*#__PURE__*/_jsx(Post,{post:post,className:\"post\"},post.id))]});}","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","userService","postService","AuthContext","useLoading","Typography","Box","Button","Post","CreatePost","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","Profile","id","user","profile","setProfile","posts","setPosts","error","setError","setLoading","fetchProfile","userResponse","get","postsResponse","getPostsByUser","err","_err$response","_err$response2","_err$response3","_err$response3$data","response","status","data","detail","message","className","children","isOwnProfile","parseInt","variant","gutterBottom","name","login","color","component","href","style","margin","userId","onPostCreated","marginTop","length","map","post"],"sources":["C:/Users/zo-al/Desktop/studa_practe/frontend/src/components/Profile.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { userService } from '../services/userService';\r\nimport { postService } from '../services/postService';\r\nimport { AuthContext } from '../contexts/AuthContext';\r\nimport { useLoading } from '../contexts/LoadingContext';\r\nimport { Typography, Box, Button } from '@mui/material';\r\nimport Post from './Post';\r\nimport { CreatePost } from './CreatePost';\r\n\r\nexport function Profile() {\r\n  const { id } = useParams();\r\n  const { user } = useContext(AuthContext);\r\n  const [profile, setProfile] = useState(null);\r\n  const [posts, setPosts] = useState([]);\r\n  const [error, setError] = useState(null);\r\n  const { setLoading } = useLoading();\r\n\r\n  const fetchProfile = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const userResponse = await userService.get(id);\r\n      setProfile(userResponse);\r\n      const postsResponse = await postService.getPostsByUser(id);\r\n      setPosts(postsResponse);\r\n    } catch (err) {\r\n      setError(\r\n        err.response?.status === 401\r\n          ? 'Необходима авторизация'\r\n          : err.response?.status === 404\r\n          ? 'Пользователь или посты не найдены'\r\n          : err.response?.data?.detail || err.message || 'Произошла ошибка при загрузке профиля'\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProfile();\r\n  }, [id, setLoading]);\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Ошибка: {error}</div>;\r\n  }\r\n\r\n  if (!profile) {\r\n    return <Typography className=\"container\">Загрузка...</Typography>;\r\n  }\r\n\r\n  const isOwnProfile = user && user.id === parseInt(id);\r\n\r\n  return (\r\n    <Box className=\"container\">\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        Профиль {profile.name || `User ${profile.id}`}\r\n      </Typography>\r\n      <Typography variant=\"subtitle1\">Логин: {profile.login}</Typography>\r\n      {isOwnProfile && (\r\n        <>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            component=\"a\"\r\n            href={`/users/${id}/update`}\r\n            style={{ margin: '1rem 0' }}\r\n          >\r\n            Обновить профиль\r\n          </Button>\r\n          <CreatePost userId={id} onPostCreated={fetchProfile} />\r\n        </>\r\n      )}\r\n      <Typography variant=\"h5\" gutterBottom style={{ marginTop: '2rem' }}>\r\n        Посты\r\n      </Typography>\r\n      {posts.length === 0 ? (\r\n        <Typography>Нет постов</Typography>\r\n      ) : (\r\n        posts.map((post) => <Post key={post.id} post={post} className=\"post\" />)\r\n      )}\r\n    </Box>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}