{"ast":null,"code":"// frontend/src/components/Update.js\nimport React,{useState,useEffect,useContext}from'react';import{useParams,useNavigate}from'react-router-dom';import{userService}from'../services/userService';import{AuthContext}from'../contexts/AuthContext';import{useLoading}from'../contexts/LoadingContext';import{TextField,Button,Typography,Box}from'@mui/material';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";export default function Update(){const{id}=useParams();const navigate=useNavigate();const{user,setUser}=useContext(AuthContext);const{setLoading}=useLoading();const[name,setName]=useState('');const[error,setError]=useState(null);useEffect(()=>{if(!user||parseInt(id)!==user.id){navigate(`/users/${id}`);return;}setLoading(true);userService.get(id).then(response=>{setName(response.name||'');setLoading(false);}).catch(err=>{var _err$response,_err$response2,_err$response3,_err$response3$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401?'Необходима авторизация':((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===404?'Пользователь не найден':((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.detail)||err.message||'Произошла ошибка при загрузке данных');setLoading(false);});},[id,user,navigate,setLoading]);const handleSubmit=async e=>{e.preventDefault();setLoading(true);try{const updatedUser=await userService.update(id,{name});setUser(updatedUser);navigate(`/users/${id}`);}catch(err){var _err$response4,_err$response5,_err$response6,_err$response6$data;setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.status)===401?'Необходима авторизация':((_err$response5=err.response)===null||_err$response5===void 0?void 0:_err$response5.status)===404?'Пользователь не найден':((_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.detail)||err.message||'Произошла ошибка при сохранении');}finally{setLoading(false);}};if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});}return/*#__PURE__*/_jsxs(Box,{className:\"container\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{label:\"\\u0418\\u043C\\u044F\",value:name,onChange:e=>setName(e.target.value),fullWidth:true,margin:\"normal\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,style:{marginTop:'1rem'},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","useNavigate","userService","AuthContext","useLoading","TextField","Button","Typography","Box","jsxs","_jsxs","jsx","_jsx","Update","id","navigate","user","setUser","setLoading","name","setName","error","setError","parseInt","get","then","response","catch","err","_err$response","_err$response2","_err$response3","_err$response3$data","status","data","detail","message","handleSubmit","e","preventDefault","updatedUser","update","_err$response4","_err$response5","_err$response6","_err$response6$data","className","children","variant","gutterBottom","onSubmit","label","value","onChange","target","fullWidth","margin","type","color","style","marginTop"],"sources":["C:/Users/zo-al/Desktop/studa_practe/frontend/src/components/Update.js"],"sourcesContent":["// frontend/src/components/Update.js\r\nimport React, { useState, useEffect, useContext } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { userService } from '../services/userService';\r\nimport { AuthContext } from '../contexts/AuthContext';\r\nimport { useLoading } from '../contexts/LoadingContext';\r\nimport { TextField, Button, Typography, Box } from '@mui/material';\r\n\r\nexport default function Update() {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user, setUser } = useContext(AuthContext);\r\n  const { setLoading } = useLoading();\r\n  const [name, setName] = useState('');\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!user || parseInt(id) !== user.id) {\r\n      navigate(`/users/${id}`);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    userService\r\n      .get(id)\r\n      .then((response) => {\r\n        setName(response.name || '');\r\n        setLoading(false);\r\n      })\r\n      .catch((err) => {\r\n        setError(\r\n          err.response?.status === 401\r\n            ? 'Необходима авторизация'\r\n            : err.response?.status === 404\r\n            ? 'Пользователь не найден'\r\n            : err.response?.data?.detail || err.message || 'Произошла ошибка при загрузке данных'\r\n        );\r\n        setLoading(false);\r\n      });\r\n  }, [id, user, navigate, setLoading]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      const updatedUser = await userService.update(id, { name });\r\n      setUser(updatedUser);\r\n      navigate(`/users/${id}`);\r\n    } catch (err) {\r\n      setError(\r\n        err.response?.status === 401\r\n          ? 'Необходима авторизация'\r\n          : err.response?.status === 404\r\n          ? 'Пользователь не найден'\r\n          : err.response?.data?.detail || err.message || 'Произошла ошибка при сохранении'\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Ошибка: {error}</div>;\r\n  }\r\n\r\n  return (\r\n    <Box className=\"container\">\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        Обновить профиль\r\n      </Typography>\r\n      <form onSubmit={handleSubmit}>\r\n        <TextField\r\n          label=\"Имя\"\r\n          value={name}\r\n          onChange={(e) => setName(e.target.value)}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          fullWidth\r\n          style={{ marginTop: '1rem' }}\r\n        >\r\n          Сохранить\r\n        </Button>\r\n      </form>\r\n    </Box>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}